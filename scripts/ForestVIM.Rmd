---
title: "Forest Variable Importance"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(semtree)
```

```{r load forest}
# forestdata <- readRDS("data/forestfile.RData")
```

```{r load vim}
vim <- readRDS("data/forestvim.RData")
```

```{r extracting importance values}
sort.values = T 
aggregate = "mean" 
horiz = T
las = 1 
convergence = F 
scale = "absolute" 
xlim = NULL 
head = NULL 
tail = NULL 
na.omit = FALSE

vimp <- vim
x <- semtree:::aggregateVarimp(vimp, aggregate, scale, na.omit)

vnames <- vimp$var.names
low <- min(x, na.rm = T) - 1
filt <- is.na(x)
x[filt] <- low
srt <- sort(x, index.return = T)
x <- x[srt$ix]
vnames <- vnames[srt$ix]
x[x <= (low + 0.5)] <- NA

selection <- 1:length(x)

impmat <- x[selection]
impmat
```

```{r}
plot(vim)

print(vim)
```